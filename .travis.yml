before_install:
  - sudo apt-get update
  - sudo apt-get install -y libpthread-stubs0-dev libgl1-mesa-dev libx11-dev libxrandr-dev libfreetype6-dev libglew1.5-dev libjpeg8-dev libsndfile1-dev libopenal-dev libudev-dev libxcb-image0-dev libjpeg-dev libflac-dev libsfml-dev
language: cpp
compiler: clang
services: xvfb
dist: bionic
before_script:
  # SFML
  - wget https://www.sfml-dev.org/files/SFML-2.5.1-sources.zip
  - unzip SFML-2.5.1-sources.zip
  - cd SFML-2.5.1
  - mkdir build && cd build
  - cmake -DCMAKE_INSTALL_PREFIX=${TRAVIS_BUILD_DIR}/usr .. ;
  # Cmake
  - mkdir -p build && cd build
  - cmake -DCMAKE_INSTALL_PREFIX=${TRAVIS_BUILD_DIR}/usr -DCMAKE_CXX_FLAGS="-I${TRAVIS_BUILD_DIR}/usr/include ..
  - cmake --build . -- -j
  - cd ..
script:
  - bash -c 'if ! ./build/tests/ug-test; then >&2 echo "Fail"; exit 1; fi'
  - bash -c 'if ! xvfb-run --server-args="-screen 0 1280x1024x24" -e /dev/stdout -a node tests/integration/smoke_tests.js; then >&2 echo "Fail"; exit 1; fi'
